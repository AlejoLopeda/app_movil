<template>
  <ion-app>
    <!-- üëá Men√∫ lateral -->
    <ion-menu menu-id="main-menu" content-id="main-content" @ionWillOpen="onSideMenuWillOpen">
      <ion-header>
        <ion-toolbar color="primary">
          <ion-title>Men√∫</ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content>
        <ion-list>
          <ion-menu-toggle auto-hide="true">
            <ion-item button router-link="/dashboard">Dashboard</ion-item>
          </ion-menu-toggle>

          <ion-menu-toggle auto-hide="true">
            <ion-item button router-link="/monto">Monto inicial</ion-item>
          </ion-menu-toggle>

          <ion-menu-toggle auto-hide="true">
            <ion-item button router-link="/ingresos/nuevo">A√±adir ingreso</ion-item>
          </ion-menu-toggle>
        </ion-list>
      </ion-content>
    </ion-menu>

    <!-- üëá Contenedor principal (id debe coincidir con content-id del men√∫) -->
    <ion-router-outlet id="main-content" />
  </ion-app>
</template>

<script setup>
import {
  IonApp, IonRouterOutlet, IonMenu, IonHeader, IonToolbar, IonTitle,
  IonContent, IonList, IonItem, IonMenuToggle
} from '@ionic/vue'
import { useRouter } from 'vue-router'
import { useAuth } from '@/composables/useAuth'

const router = useRouter()
const { logout } = useAuth()

const handleLogout = async () => {
  await logout()
  router.replace('/login')
}

/** üëá se dispara cada vez que se va a abrir el men√∫ lateral */
const onSideMenuWillOpen = () => {
  window.dispatchEvent(new CustomEvent('close-user-speed'))
}
</script>
